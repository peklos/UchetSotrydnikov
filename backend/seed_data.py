import sqlite3
import os
from database import get_db
from routers.auth import hash_password


def seed_all():
    db = get_db()

    # Check if already seeded
    count = db.execute("SELECT COUNT(*) as cnt FROM roles").fetchone()["cnt"]
    if count > 0:
        db.close()
        return

    # Roles
    db.executemany("INSERT INTO roles (name, description) VALUES (?, ?)", [
        ("Администратор", "Полный доступ к системе"),
        ("Менеджер по кадрам", "Управление сотрудниками и кадровыми событиями"),
        ("Руководитель подразделения", "Просмотр данных подразделения"),
        ("Сотрудник", "Просмотр собственного профиля"),
    ])

    # Admin user
    db.execute("INSERT INTO users (username, password_hash, full_name, role_id) VALUES (?, ?, ?, ?)",
               ("admin", hash_password("admin123"), "Администратор системы", 1))
    db.execute("INSERT INTO users (username, password_hash, full_name, role_id) VALUES (?, ?, ?, ?)",
               ("kadry", hash_password("kadry123"), "Иванова Мария Петровна", 2))
    db.execute("INSERT INTO users (username, password_hash, full_name, role_id) VALUES (?, ?, ?, ?)",
               ("user", hash_password("user123"), "Петров Сергей Иванович", 4))

    # Departments
    departments = [
        ("Дирекция", "Руководство филармонии", "Дегтерёв М.Н.", "+7(4832)12-34-56"),
        ("Симфонический оркестр", "Брянский Губернаторский симфонический оркестр", "Козлов А.В.", "+7(4832)12-34-57"),
        ("Ансамбль «Ватага»", "Ансамбль народной музыки", "Сидоров П.А.", "+7(4832)12-34-58"),
        ("Ансамбль «Стожары»", "Вокально-инструментальный ансамбль", "Кузнецов И.С.", "+7(4832)12-34-59"),
        ("Ансамбль «Надея»", "Ансамбль народных инструментов", "Морозова Л.В.", "+7(4832)12-34-60"),
        ("Отдел кадров", "Кадровое делопроизводство", "Иванова М.П.", "+7(4832)12-34-61"),
        ("Бухгалтерия", "Финансовый учёт и отчётность", "Соколова Т.А.", "+7(4832)12-34-62"),
        ("Технический отдел", "Звук, свет, сцена", "Волков Д.М.", "+7(4832)12-34-63"),
        ("Концертный отдел", "Организация концертов и мероприятий", "Новикова Е.К.", "+7(4832)12-34-64"),
        ("Шоу-балет «ЭРклеЗ»", "Танцевальный коллектив", "Белова О.С.", "+7(4832)12-34-65"),
    ]
    db.executemany("INSERT INTO departments (name, description, head_name, phone) VALUES (?, ?, ?, ?)", departments)

    # Positions
    positions = [
        ("Генеральный директор", 1, 120000, 150000, "Руководство филармонией"),
        ("Заместитель директора", 1, 90000, 110000, "Заместитель руководителя"),
        ("Художественный руководитель", 2, 100000, 130000, "Художественное руководство оркестром"),
        ("Главный дирижёр", 2, 95000, 120000, "Дирижирование оркестром"),
        ("Концертмейстер", 2, 70000, 90000, "Первая скрипка оркестра"),
        ("Артист оркестра", 2, 45000, 70000, "Исполнение партий в оркестре"),
        ("Солист-вокалист", 3, 50000, 75000, "Сольное вокальное исполнение"),
        ("Артист ансамбля", 3, 40000, 60000, "Участие в ансамбле"),
        ("Артист ансамбля", 4, 40000, 60000, "Участие в ВИА"),
        ("Артист ансамбля", 5, 40000, 60000, "Участие в ансамбле народных инструментов"),
        ("Начальник отдела кадров", 6, 55000, 70000, "Руководство отделом кадров"),
        ("Специалист по кадрам", 6, 35000, 50000, "Ведение кадрового делопроизводства"),
        ("Главный бухгалтер", 7, 70000, 90000, "Руководство бухгалтерией"),
        ("Бухгалтер", 7, 35000, 50000, "Финансовый учёт"),
        ("Звукорежиссёр", 8, 45000, 65000, "Управление звуковым оборудованием"),
        ("Светооператор", 8, 35000, 50000, "Управление освещением"),
        ("Инженер сцены", 8, 40000, 55000, "Техническое обеспечение сцены"),
        ("Администратор зала", 9, 30000, 40000, "Организация работы зрительного зала"),
        ("Концертный менеджер", 9, 45000, 60000, "Организация концертных мероприятий"),
        ("Артист балета", 10, 40000, 55000, "Участие в шоу-балете"),
    ]
    db.executemany("INSERT INTO positions (name, department_id, salary_min, salary_max, description) VALUES (?, ?, ?, ?, ?)", positions)

    # Employees
    employees = [
        ("Дегтерёв", "Максим", "Николаевич", "1975-03-15", "М", "3201001001", "001-001-001 01", "32 01", "100001", "г. Брянск, ул. Калинина, д. 1", "+79101234567", "degteryov@philharmonic.ru", 1, 1, "2010-01-15", 140000, "штатный", "работает"),
        ("Козлов", "Андрей", "Викторович", "1980-07-22", "М", "3201001002", "001-001-002 02", "32 02", "100002", "г. Брянск, ул. Ленина, д. 10", "+79101234568", "kozlov@philharmonic.ru", 2, 3, "2012-09-01", 115000, "штатный", "работает"),
        ("Иванова", "Мария", "Петровна", "1985-11-03", "Ж", "3201001003", "001-001-003 03", "32 03", "100003", "г. Брянск, пр. Московский, д. 5", "+79101234569", "ivanova@philharmonic.ru", 6, 11, "2015-03-10", 62000, "штатный", "работает"),
        ("Соколова", "Татьяна", "Алексеевна", "1978-05-14", "Ж", "3201001004", "001-001-004 04", "32 04", "100004", "г. Брянск, ул. Красноармейская, д. 20", "+79101234570", "sokolova@philharmonic.ru", 7, 13, "2011-06-01", 82000, "штатный", "работает"),
        ("Волков", "Дмитрий", "Михайлович", "1990-09-28", "М", "3201001005", "001-001-005 05", "32 05", "100005", "г. Брянск, ул. Фокина, д. 15", "+79101234571", "volkov@philharmonic.ru", 8, 15, "2018-02-20", 55000, "штатный", "работает"),
        ("Петрова", "Елена", "Сергеевна", "1992-01-17", "Ж", "3201001006", "001-001-006 06", "32 06", "100006", "г. Брянск, б-р Гагарина, д. 8", "+79101234572", "petrova@philharmonic.ru", 2, 6, "2019-09-01", 52000, "штатный", "работает"),
        ("Смирнов", "Алексей", "Иванович", "1988-04-05", "М", "3201001007", "001-001-007 07", "32 07", "100007", "г. Брянск, ул. Дуки, д. 30", "+79101234573", "smirnov@philharmonic.ru", 2, 6, "2017-01-10", 58000, "штатный", "работает"),
        ("Новикова", "Екатерина", "Константиновна", "1987-12-20", "Ж", "3201001008", "001-001-008 08", "32 08", "100008", "г. Брянск, ул. Советская, д. 12", "+79101234574", "novikova@philharmonic.ru", 9, 19, "2016-04-15", 52000, "штатный", "работает"),
        ("Кузнецов", "Игорь", "Сергеевич", "1983-08-11", "М", "3201001009", "001-001-009 09", "32 09", "100009", "г. Брянск, ул. Литейная, д. 7", "+79101234575", "kuznetsov@philharmonic.ru", 4, 9, "2014-10-01", 48000, "штатный", "работает"),
        ("Морозова", "Людмила", "Владимировна", "1979-06-30", "Ж", "3201001010", "001-001-010 10", "32 10", "100010", "г. Брянск, ул. Ромашина, д. 22", "+79101234576", "morozova@philharmonic.ru", 5, 10, "2013-05-20", 50000, "штатный", "работает"),
        ("Белова", "Ольга", "Сергеевна", "1995-02-25", "Ж", "3201001011", "001-001-011 11", "32 11", "100011", "г. Брянск, ул. Горького, д. 3", "+79101234577", "belova@philharmonic.ru", 10, 20, "2020-01-15", 42000, "штатный", "работает"),
        ("Сидоров", "Павел", "Андреевич", "1986-10-08", "М", "3201001012", "001-001-012 12", "32 12", "100012", "г. Брянск, пер. Пионерский, д. 5", "+79101234578", "sidorov@philharmonic.ru", 3, 7, "2015-08-01", 55000, "штатный", "работает"),
        ("Васильева", "Анна", "Дмитриевна", "1993-07-19", "Ж", "3201001013", "001-001-013 13", "32 13", "100013", "г. Брянск, ул. Крахмалёва, д. 18", "+79101234579", "vasilieva@philharmonic.ru", 6, 12, "2021-03-01", 38000, "штатный", "работает"),
        ("Фёдоров", "Николай", "Александрович", "1991-03-12", "М", "3201001014", "001-001-014 14", "32 14", "100014", "г. Брянск, ул. Бежицкая, д. 40", "+79101234580", "fedorov@philharmonic.ru", 8, 17, "2019-11-15", 45000, "штатный", "работает"),
        ("Егорова", "Светлана", "Викторовна", "1984-09-07", "Ж", "3201001015", "001-001-015 15", "32 15", "100015", "г. Брянск, ул. Институтская, д. 9", "+79101234581", "egorova@philharmonic.ru", 2, 5, "2013-02-01", 78000, "штатный", "работает"),
        ("Попов", "Виктор", "Олегович", "1996-11-23", "М", "3201001016", "001-001-016 16", "32 16", "100016", "г. Брянск, ул. Орловская, д. 14", "+79101234582", "popov@philharmonic.ru", 2, 6, "2022-06-01", 47000, "срочный договор", "работает"),
        ("Лебедева", "Ирина", "Николаевна", "1989-04-30", "Ж", "3201001017", "001-001-017 17", "32 17", "100017", "г. Брянск, ул. Тютчева, д. 6", "+79101234583", "lebedeva@philharmonic.ru", 7, 14, "2017-07-10", 40000, "штатный", "работает"),
        ("Григорьев", "Олег", "Петрович", "1982-02-14", "М", "3201001018", "001-001-018 18", "32 18", "100018", "г. Брянск, ул. Емлютина, д. 25", "+79101234584", "grigoriev@philharmonic.ru", 8, 16, "2016-09-01", 42000, "штатный", "в отпуске"),
        ("Андреева", "Наталья", "Игоревна", "1994-06-11", "Ж", "3201001019", "001-001-019 19", "32 19", "100019", "г. Брянск, ул. Пересвета, д. 11", "+79101234585", "andreeva@philharmonic.ru", 9, 18, "2020-08-15", 33000, "штатный", "работает"),
        ("Тимофеев", "Сергей", "Владимирович", "1977-12-01", "М", "3201001020", "001-001-020 20", "32 20", "100020", "г. Брянск, ул. 3-го Интернационала, д. 7", "+79101234586", "timofeev@philharmonic.ru", 2, 4, "2009-03-01", 105000, "штатный", "работает"),
    ]

    for emp in employees:
        db.execute("""
            INSERT INTO employees (last_name, first_name, middle_name, birth_date, gender, inn, snils,
                passport_series, passport_number, address, phone, email, department_id, position_id,
                hire_date, salary, employment_type, status)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        """, emp)

    # Education
    education_data = [
        (1, "Московская государственная консерватория", "Музыковедение", "специалист", 1993, 1998, "МК-001"),
        (2, "Российская академия музыки им. Гнесиных", "Дирижирование", "магистр", 1998, 2003, "РАМ-001"),
        (3, "Брянский государственный университет", "Управление персоналом", "бакалавр", 2003, 2007, "БГУ-001"),
        (4, "Финансовый университет при Правительстве РФ", "Бухгалтерский учёт", "специалист", 1996, 2001, "ФУ-001"),
        (5, "Брянский государственный технический университет", "Звукорежиссура", "бакалавр", 2008, 2012, "БГТУ-001"),
        (6, "Санкт-Петербургская консерватория", "Оркестровые инструменты", "магистр", 2010, 2015, "СПбК-001"),
        (7, "Московская консерватория", "Скрипка", "специалист", 2005, 2010, "МК-002"),
        (15, "Московская консерватория", "Скрипка", "магистр", 2002, 2007, "МК-003"),
        (20, "Российская академия музыки им. Гнесиных", "Дирижирование", "специалист", 1995, 2000, "РАМ-002"),
        (12, "Брянское музыкальное училище", "Вокал", "среднее специальное", 2001, 2005, "БМУ-001"),
    ]
    db.executemany("INSERT INTO education (employee_id, institution, speciality, degree, year_start, year_end, diploma_number) VALUES (?, ?, ?, ?, ?, ?, ?)", education_data)

    # Staff events
    events_data = [
        (1, "приём", "2010-01-15", None, "Приём на должность генерального директора", "ПР-001/2010", 1),
        (2, "приём", "2012-09-01", None, "Приём на должность художественного руководителя", "ПР-015/2012", 1),
        (3, "приём", "2015-03-10", None, "Приём на должность начальника отдела кадров", "ПР-008/2015", 1),
        (6, "приём", "2019-09-01", None, "Приём в оркестр", "ПР-022/2019", 1),
        (16, "приём", "2022-06-01", None, "Приём по срочному трудовому договору на концертный сезон", "ПР-035/2022", 1),
        (18, "отпуск", "2025-01-15", "2025-02-15", "Ежегодный оплачиваемый отпуск", "ОТП-003/2025", 1),
        (7, "повышение", "2023-04-01", None, "Повышение оклада за выслугу лет", "ПР-012/2023", 1),
        (15, "премия", "2024-12-20", None, "Премия по итогам концертного сезона", "ПР-045/2024", 1),
        (5, "командировка", "2024-11-01", "2024-11-10", "Гастроли в Москве", "КОМ-005/2024", 1),
        (11, "приём", "2020-01-15", None, "Приём в шоу-балет", "ПР-002/2020", 1),
    ]
    db.executemany("""INSERT INTO staff_events (employee_id, event_type, event_date, end_date, description, document_number, created_by)
                      VALUES (?, ?, ?, ?, ?, ?, ?)""", events_data)

    # Contacts
    contacts_data = [
        (1, "телефон", "+79101234567", 1),
        (1, "email", "degteryov@philharmonic.ru", 1),
        (2, "телефон", "+79101234568", 1),
        (3, "телефон", "+79101234569", 1),
        (3, "email", "ivanova@philharmonic.ru", 1),
        (5, "telegram", "@volkov_sound", 0),
    ]
    db.executemany("INSERT INTO contacts (employee_id, contact_type, contact_value, is_primary) VALUES (?, ?, ?, ?)", contacts_data)

    db.commit()
    db.close()
    print("Database seeded successfully!")
